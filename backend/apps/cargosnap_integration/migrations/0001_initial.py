# Generated by Django 5.0.1 on 2025-11-25 16:23

import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='CargoSnapSyncLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('finished_at', models.DateTimeField(blank=True, null=True)),
                ('status', models.CharField(choices=[('running', 'Executando'), ('completed', 'Completo'), ('error', 'Erro'), ('partial', 'Parcial')], default='running', max_length=20)),
                ('files_processed', models.IntegerField(default=0)),
                ('files_created', models.IntegerField(default=0)),
                ('files_updated', models.IntegerField(default=0)),
                ('files_failed', models.IntegerField(default=0)),
                ('images_downloaded', models.IntegerField(default=0)),
                ('images_failed', models.IntegerField(default=0)),
                ('total_pages', models.IntegerField(default=0)),
                ('current_page', models.IntegerField(default=0)),
                ('error_message', models.TextField(blank=True, null=True)),
                ('details', models.JSONField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Log de Sincronização',
                'verbose_name_plural': 'Logs de Sincronização',
                'db_table': 'cargosnap_sync_logs',
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='CargoSnapWorkflow',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('cargosnap_id', models.IntegerField(db_index=True, unique=True)),
                ('tenant_id', models.IntegerField()),
                ('name', models.CharField(max_length=500)),
                ('workflow_type', models.CharField(max_length=50)),
                ('force', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField()),
                ('updated_at', models.DateTimeField()),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('language', models.CharField(blank=True, max_length=10, null=True)),
                ('location_filter', models.CharField(blank=True, max_length=200, null=True)),
                ('close_file_after_completion', models.BooleanField(default=False)),
                ('order', models.IntegerField(default=0)),
                ('clear_app_after_completion', models.BooleanField(default=False)),
                ('info_url', models.URLField(blank=True, max_length=1000, null=True)),
            ],
            options={
                'verbose_name': 'Workflow CargoSnap',
                'verbose_name_plural': 'Workflows CargoSnap',
                'db_table': 'cargosnap_workflows',
                'ordering': ['order', 'name'],
            },
        ),
        migrations.CreateModel(
            name='CargoSnapFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('cargosnap_id', models.BigIntegerField(db_index=True, unique=True)),
                ('scan_code', models.CharField(db_index=True, help_text='Código do container', max_length=100)),
                ('scan_code_format', models.CharField(blank=True, max_length=50, null=True)),
                ('closed', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField()),
                ('updated_at', models.DateTimeField()),
                ('recent_snap_id', models.BigIntegerField(blank=True, null=True)),
                ('snap_count', models.IntegerField(default=0)),
                ('snap_count_with_damage', models.IntegerField(default=0)),
                ('last_synced_at', models.DateTimeField(auto_now=True)),
                ('sync_status', models.CharField(choices=[('pending', 'Pendente'), ('syncing', 'Sincronizando'), ('completed', 'Completo'), ('error', 'Erro')], default='pending', max_length=20)),
                ('sync_error', models.TextField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Arquivo CargoSnap',
                'verbose_name_plural': 'Arquivos CargoSnap',
                'db_table': 'cargosnap_files',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['scan_code', '-created_at'], name='cargosnap_f_scan_co_02059c_idx'), models.Index(fields=['sync_status'], name='cargosnap_f_sync_st_5f1e62_idx')],
            },
        ),
        migrations.CreateModel(
            name='CargoSnapField',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('field_name', models.CharField(max_length=200)),
                ('field_value', models.TextField()),
                ('field_data', models.JSONField(blank=True, help_text='Dados completos do campo', null=True)),
                ('file', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='fields', to='cargosnap_integration.cargosnapfile')),
            ],
            options={
                'verbose_name': 'Campo CargoSnap',
                'verbose_name_plural': 'Campos CargoSnap',
                'db_table': 'cargosnap_fields',
            },
        ),
        migrations.CreateModel(
            name='CargoSnapFormSubmit',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('cargosnap_id', models.IntegerField(db_index=True, unique=True)),
                ('form_data', models.JSONField(help_text='Dados completos do formulário')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('file', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='form_submits', to='cargosnap_integration.cargosnapfile')),
            ],
            options={
                'verbose_name': 'Formulário Submetido',
                'verbose_name_plural': 'Formulários Submetidos',
                'db_table': 'cargosnap_form_submits',
            },
        ),
        migrations.CreateModel(
            name='CargoSnapWorkflowRun',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('cargosnap_id', models.IntegerField(db_index=True, unique=True)),
                ('client_key', models.CharField(max_length=50)),
                ('tenant_id', models.IntegerField()),
                ('submit_date_time', models.DateTimeField()),
                ('created_at', models.DateTimeField()),
                ('updated_at', models.DateTimeField()),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('started_on_device_at', models.DateTimeField(blank=True, null=True)),
                ('finished_on_device_at', models.DateTimeField(blank=True, null=True)),
                ('file', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='workflow_runs', to='cargosnap_integration.cargosnapfile')),
                ('workflow', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='runs', to='cargosnap_integration.cargosnapworkflow')),
            ],
            options={
                'verbose_name': 'Execução de Workflow',
                'verbose_name_plural': 'Execuções de Workflow',
                'db_table': 'cargosnap_workflow_runs',
                'ordering': ['-submit_date_time'],
            },
        ),
        migrations.CreateModel(
            name='CargoSnapWorkflowStep',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('cargosnap_id', models.IntegerField(db_index=True, unique=True)),
                ('tenant_id', models.IntegerField()),
                ('order', models.IntegerField()),
                ('description', models.CharField(max_length=500)),
                ('step_type', models.CharField(max_length=50)),
                ('allow_skip', models.BooleanField(default=False)),
                ('platform_description', models.CharField(blank=True, max_length=500, null=True)),
                ('data', models.JSONField(blank=True, null=True)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('info_url', models.URLField(blank=True, max_length=1000, null=True)),
                ('workflow', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='steps', to='cargosnap_integration.cargosnapworkflow')),
            ],
            options={
                'verbose_name': 'Etapa de Workflow',
                'verbose_name_plural': 'Etapas de Workflow',
                'db_table': 'cargosnap_workflow_steps',
                'ordering': ['workflow', 'order'],
            },
        ),
        migrations.CreateModel(
            name='CargoSnapWorkflowRunStep',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('cargosnap_id', models.IntegerField(db_index=True, unique=True)),
                ('entity_type', models.CharField(max_length=50)),
                ('status', models.CharField(max_length=50)),
                ('entity_ids', models.JSONField(help_text='Array de IDs das entidades relacionadas')),
                ('device_id', models.IntegerField()),
                ('tenant_id', models.IntegerField()),
                ('submit_date_time', models.DateTimeField()),
                ('created_at', models.DateTimeField()),
                ('updated_at', models.DateTimeField()),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('workflow_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='run_steps', to='cargosnap_integration.cargosnapworkflowrun')),
                ('workflow_step', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='executions', to='cargosnap_integration.cargosnapworkflowstep')),
            ],
            options={
                'verbose_name': 'Etapa Executada',
                'verbose_name_plural': 'Etapas Executadas',
                'db_table': 'cargosnap_workflow_run_steps',
                'ordering': ['workflow_run', 'submit_date_time'],
            },
        ),
        migrations.CreateModel(
            name='CargoSnapLocation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('cargosnap_id', models.IntegerField()),
                ('location', models.CharField(max_length=500)),
                ('file', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='locations', to='cargosnap_integration.cargosnapfile')),
            ],
            options={
                'verbose_name': 'Localização CargoSnap',
                'verbose_name_plural': 'Localizações CargoSnap',
                'db_table': 'cargosnap_locations',
                'unique_together': {('file', 'cargosnap_id')},
            },
        ),
        migrations.CreateModel(
            name='CargoSnapUpload',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('cargosnap_id', models.BigIntegerField(db_index=True, unique=True)),
                ('tenant_id', models.IntegerField()),
                ('device_id', models.IntegerField()),
                ('device_nick', models.CharField(blank=True, max_length=200, null=True)),
                ('upload_type', models.CharField(max_length=50)),
                ('created_at', models.DateTimeField()),
                ('scan_date_time', models.DateTimeField()),
                ('longitude', models.CharField(blank=True, max_length=50, null=True)),
                ('latitude', models.CharField(blank=True, max_length=50, null=True)),
                ('geocoding_data', models.JSONField(blank=True, help_text='Dados completos de geocoding', null=True)),
                ('has_damage', models.BooleanField(default=False)),
                ('damage_type_id', models.IntegerField(blank=True, null=True)),
                ('damage_type_desc', models.CharField(blank=True, max_length=200, null=True)),
                ('comment', models.TextField(blank=True, null=True)),
                ('document_type_id', models.IntegerField(blank=True, null=True)),
                ('document_type_desc', models.CharField(blank=True, max_length=200, null=True)),
                ('workflow_id', models.IntegerField(blank=True, null=True)),
                ('workflow_step_id', models.IntegerField(blank=True, null=True)),
                ('workflow_description', models.CharField(blank=True, max_length=500, null=True)),
                ('workflow_step_description', models.CharField(blank=True, max_length=500, null=True)),
                ('image_path', models.CharField(max_length=500)),
                ('image_url', models.URLField(max_length=1000)),
                ('image_thumb', models.URLField(max_length=1000)),
                ('local_image_path', models.CharField(blank=True, help_text='Caminho da imagem baixada localmente', max_length=500, null=True)),
                ('local_thumb_path', models.CharField(blank=True, help_text='Caminho da thumbnail baixada localmente', max_length=500, null=True)),
                ('image_downloaded', models.BooleanField(default=False)),
                ('file', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='uploads', to='cargosnap_integration.cargosnapfile')),
            ],
            options={
                'verbose_name': 'Upload CargoSnap',
                'verbose_name_plural': 'Uploads CargoSnap',
                'db_table': 'cargosnap_uploads',
                'ordering': ['scan_date_time'],
                'indexes': [models.Index(fields=['file', 'scan_date_time'], name='cargosnap_u_file_id_6ae671_idx'), models.Index(fields=['workflow_id'], name='cargosnap_u_workflo_ede4ac_idx'), models.Index(fields=['has_damage'], name='cargosnap_u_has_dam_6b4062_idx'), models.Index(fields=['image_downloaded'], name='cargosnap_u_image_d_1b1754_idx')],
            },
        ),
    ]
